<html>
  <head>
    <title>Sign up</title>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript">
      function e(id) {
        return document.getElementById(id);
      }
      function setUType(b) {
        if (b) {
          e("cmp").disabled = true;
          e("fst").disabled = false;
          e("lst").disabled = false;
        }
        else {
          e("cmp").disabled = false;
          e("fst").disabled = true;
          e("lst").disabled = true;
        }
      }

      function newGuid() {
        // Courtesy of stackoverflow, rfc4122 version 4 compliant
        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
          var r = Math.random()*16|0, v = c == 'x' ? r : (r&0x3|0x8);
          return v.toString(16);
        });
      }

      function submit() {
        var fst = '', lst = '', cmp = '';
        if (e('cmp').disabled) {
          fst = e('fst').value;
          lst = e('lst').value;
        }
        else {
          cmp = e('cmp').value;
        }
        var lang = e('lang').value;
        var aid = newGuid();
        $.ajax({
          url: '../' + aid + '/Account',
          type: "POST",
          data: { id: aid, fst: fst, lst: lst, cmp: cmp, lang: lang },
          dataType: "json",
          success: function(data, textStatus, jqXHR) {
            if (data == null) {
              $('#result').empty().append('Account already exists.');
            }
            else {
              e("sub").disabled = true;
              $('#result').empty().append('Account created successfully!<br />');
              $('#result').append('Redirecting you to Account home...');
              setTimeout(function() {
                window.location.href = '../' + aid + '/Account';
              }, 2000);
            }
          },
          error: function(jqXHR, textStatus, errorThrown) { alert('o noes!'); }
        });
      }
    </script>
  </head>
  <body>
    <input type="radio" name="utype" value="person" onclick="setUType(true)" checked="true" /> Person<br />
    <input type="radio" name="utype" value="company" onclick="setUType(false)" /> Company<br /><br />
    First Name: <input type="text" id="fst" /> Last Name: <input type="text" id="lst" />&nbsp;&nbsp;&nbsp;&nbsp;<b>OR</b>&nbsp;&nbsp;&nbsp;&nbsp;Company Name: <input type="text" id="cmp" disabled="true" /><br /><br />
    Language: <select id="lang">
      <option value="eng">English</option>
      <option value="fre">Fran&ccedil;ais</option>
      <option value="ger">Deutsch</option>
      <option value="spa">Espa&ntilde;ol</option>
    </select><br /><br />

    <button id="sub" onclick="submit()">Submit</button>
    <br /> <br />
    <div id="result"></div>
    
  </body>
</html>
